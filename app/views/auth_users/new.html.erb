<h2>Create User</h2>

<div class="row">

  <div class="col-md-6">
    <%= form_with(model: @auth_user, local: true) do |f| %>
      <%= render 'shared/error_messages' %>

      <%= f.label :email %>
      <%= f.text_field :email, class: 'mb-1 form-control' %>

      <%= f.label :password_digest %>
      <%= f.text_field :password_digest, class: 'mb-1 form-control' %>

      <hr />

      <!-- Find out why the following two work -->
      <%#= f.fields_for :auth_user_detail, AuthUserDetail.new do |details| %>
      <!-- Initialization of user details moved inside controller new -->
      <%= f.fields_for :auth_user_detail do |details| %>
      <%#= f.fields_for :auth_user_detail_attributes do |details| %>      
        <div class="user-details-form">
          <h6>User details</h6>
          <hr />
          <div>
            <%= details.label :firstname %>
            <%= details.text_field :firstname, class: 'mb-1 form-control' %>
          </div>
          <div >
            <%= details.label :lastname %>
            <%= details.text_field :lastname, class: 'mb-1 form-control' %>
          </div>
        </div>
      <% end %>

      <a href="<%= auth_users_path%>" class="mt-3 btn btn-sm btn-danger">Cancel</a>
      <%= f.submit "Create User", class: "mt-3 btn btn-sm btn-primary" %>
    <% end %>
  </div>
  
</div>